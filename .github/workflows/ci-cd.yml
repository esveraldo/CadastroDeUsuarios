      # ðŸ” VERIFICAR SECRETS ANTES DO SCP
      - name: Verificar secrets antes do SCP
        if: github.event_name == 'push' && github.ref == 'refs/heads/main'
        run: |
          echo "EC2_HOST: '${{ secrets.EC2_HOST }}'"
          echo "EC2_USER: '${{ secrets.EC2_USER }}'"
          if [ -z "${{ secrets.EC2_SSH_KEY }}" ]; then
            echo "EC2_SSH_KEY estÃ¡ VAZIO ou NÃƒO existe!"
            exit 1
          else
            echo "EC2_SSH_KEY estÃ¡ definido (conteÃºdo nÃ£o serÃ¡ exibido)."
          fi

      # CRIAR ARQUIVO DE CHAVE PRIVADA NO RUNNER
      - name: Criar arquivo de chave SSH
        if: github.event_name == 'push' && github.ref == 'refs/heads/main'
        run: |
          mkdir -p ~/.ssh
          echo "${{ secrets.EC2_SSH_KEY }}" > ~/.ssh/id_ec2
          chmod 600 ~/.ssh/id_ec2

      # COPIAR ARQUIVO PARA EC2 VIA SCP (SEM ACTION EXTERNO)
      - name: Copiar app.zip para EC2 via scp
        if: github.event_name == 'push' && github.ref == 'refs/heads/main'
        run: |
          scp -o StrictHostKeyChecking=no -i ~/.ssh/id_ec2 app.zip \
            ${{ secrets.EC2_USER }}@${{ secrets.EC2_HOST }}:/tmp/app.zip

      # DEPLOY NA EC2 VIA SSH (SEM ACTION EXTERNO)
      - name: Deploy na EC2 via ssh
        if: github.event_name == 'push' && github.ref == 'refs/heads/main'
        run: |
          ssh -o StrictHostKeyChecking=no -i ~/.ssh/id_ec2 ${{ secrets.EC2_USER }}@${{ secrets.EC2_HOST }} << 'EOF'
            sudo systemctl stop CadastroDeUsuarios || true
            rm -rf /var/www/CadastroDeUsuarios/*
            unzip -o /tmp/app.zip -d /var/www/CadastroDeUsuarios
            rm /tmp/app.zip
            sudo systemctl start CadastroDeUsuarios
          EOF
